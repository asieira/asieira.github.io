<!doctype html><html lang="en"><head><meta name="google-site-verification" content="iwCg_a-vVgFpfSWBajnl_3T97hetrL_jHS3nVkinaho"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="InfoSec Zanshin, Thoughts on information security, entrepreneurship and more."><link rel="alternate" href="https://www.infoseczanshin.com/feeds/all.atom.xml" type="application/atom+xml" title="InfoSec Zanshin Full Atom Feed"><title>Using OpenVPN Access Server to Access AWS VPCs // InfoSec Zanshin // Thoughts on information security, entrepreneurship and more.</title><link rel="apple-touch-icon" sizes="57x57" href="/images/favicon/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/images/favicon/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/images/favicon/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/images/favicon/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/images/favicon/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/images/favicon/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/images/favicon/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/images/favicon/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/images/favicon/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/images/favicon/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png"><link rel="manifest" href="/images/favicon/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/images/favicon/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://www.infoseczanshin.com/theme/css/pure.css"><link rel="stylesheet" href="https://www.infoseczanshin.com/theme/css/pygments.css"><script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.2.0/jquery.fitvids.min.js"></script><script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script></head><body><div class="pure-g-r" id="layout"><div class="sidebar pure-u"><div class="cover-img" style="background-image: url('/images/cloud_background.png')"><div class="cover-body"><header class="header"><hgroup><img class="avatar" src="/images/zanshin.png"><h1 class="brand-main"><a href="https://www.infoseczanshin.com">InfoSec Zanshin</a></h1><p class="tagline">Thoughts on information security, entrepreneurship and more.</p><p class="social"><a href="feeds/all.atom.xml" target="_blank"><i class="fa fa-rss-square fa-2x"></i></a><a href="https://br.linkedin.com/in/sieira" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a><a href="https://twitter.com/AlexandreSieira" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a><a href="https://github.com/asieira/" target="_blank"><i class="fa fa-github-square fa-2x"></i></a></p></hgroup></header></div></div></div><div class="pure-u"><div class="content"><section class="post"><header class="post-header"><h1>Using OpenVPN Access Server to Access AWS VPCs</h1><p class="post-meta"> // under <a class="post-category" href="https://www.infoseczanshin.com/tag/aws.html">AWS</a><a class="post-category" href="https://www.infoseczanshin.com/tag/linux.html">Linux</a><a class="post-category" href="https://www.infoseczanshin.com/tag/openvpn.html">OpenVPN</a></p><p class="post-meta"> // Thu 16 March 2017 </p></header></section><p>If you use AWS for anything non-trivial, you are likely using <a href="https://aws.amazon.com/documentation/vpc/">VPCs</a> and keeping some non-public subnets for resources you don't want to be accessible to the open Internet. </p><p>Usually when this is done, a <a href="https://aws.amazon.com/blogs/security/how-to-record-ssh-sessions-established-through-a-bastion-host/">bastion host</a> is set up on a VPC public subnet and accessed via SSH to reach those internal instances or resources, through secondary SSH connections or SSH tunnels. That is a good and simple solution that will work well for a simple environment with few internal services and few users that need to access it.</p><p>However, I would like to explore an alternative: using <a href="https://openvpn.net/index.php/access-server/on-amazon-cloud.html">OpenVPN Access Server</a> to create a client-to-site VPN connection to the VPC. This approach is really easy to implement and has some pretty interesting benefits:</p><ul><li><p>Easy set up of two-factor authentication with <a href="https://en.wikipedia.org/wiki/Google_Authenticator">Google Authenticator</a> or similar TOTP solutions. This is something you could also achieve with the bastion host as well using some <a href="https://sysconfig.org.uk/two-factor-authentication-with-ssh.html">PAM magic</a> if you really want to, by the way. </p></li><li><p>Use of different IP address ranges to users of different groups, which allows different <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_SecurityGroups.html">Security Group</a> inbound rules on assets for internal resources based on who the authenticated VPN users are.</p></li><li><p>A web interface for your users that simplifies the task of downloading the VPN client with the proper connection profile, which is far more manageable for users that are not of a strong technical background.</p></li><li><p>Commercial support from the team at <a href="https://openvpn.net/index.php/login.html">OpenVPN</a>.</p></li></ul><p>One of the downsides is that this solution will require you to buy <a href="https://openvpn.net/index.php/access-server/pricing.html">licenses</a> for the OpenVPN Access Server if you plan to have more than two client connections at a time. But I find them to be reasonably priced.</p><p>For the record, this was documented based on OpenVPN Access Server 2.1.4 and is meant as a rough but coherent guide to the external references I used to get this working. Hopefully it will save someone some time.</p><h2>OpenVPN Access Server Instance</h2><p>First, go to the <a href="https://aws.amazon.com/marketplace/">AWS Marketplace</a> and find the <a href="https://aws.amazon.com/marketplace/pp/B00MI40CAE">BYOL AMI for OpenVPN Access Server</a>. Then, follow their <a href="https://docs.openvpn.net/how-to-tutorialsguides/virtual-platforms/amazon-web-services-ec2-tiered-appliance-quick-start-guide/">Quick Start Guide</a> to perform the initial configuration.</p><p>A few things to keep in mind:</p><ul><li><p>Make sure you install this on a public subnet of your VPC;</p></li><li><p>Assign the OpenVPN server EC2 instance an <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/vpc-eips.html">elastic IP address</a> so that if you stop and restart it the IP address won't change.</p></li></ul><h2>Updates, Updates and More Updates</h2><p>The first thing you'll want to do after you have finished the SSH questions and are logged into the instance is to fully update it and then reboot it by running the following commands:</p><div class="highlight"><pre><span></span>sudo su -
apt-get update
apt-get dist-upgrade
shutdown -r now
</pre></div><p>Please don't skip the reboot, so that all updates actually take effect, such as updates to the kernel and to libraries that are currently being used by running processes.</p><h2>Web Server Certificates</h2><p>Now let's set up the OpenVPN Access Server web server so use <a href="https://letsencrypt.org/">Let's Encrypt</a> certificates with automated renewal.</p><p>First, as <code>root</code>, <a href="https://certbot.eff.org/#ubuntuother-other">install certbot</a>:</p><div class="highlight"><pre><span></span><span class="nb">cd</span> /root
wget https://dl.eff.org/certbot-auto
chmod a+x certbot-auto
</pre></div><p>Installing the certificates will require issuing custom commands using an OpenVPN Access Server script, so we'll need to request the certificate <a href="https://certbot.eff.org/docs/using.html#manual">manually</a>. </p><p>Choose a hostname whithin a domain whose DNS records you control. Then, do the following as <code>root</code>:</p><div class="highlight"><pre><span></span>./certbot-auto certonly --manual --preferred-challenges dns
</pre></div><p>Follow the on-screen instructions, and when requested for the domain of the certificate enter the hostname you'll use for the OpenVPN server. It will ask you to create a TXT record on the DNS configuration of the domain so that it validates that you do own the domain. </p><p>If you use Route53 then follow <a href="http://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-creating.html">these instructions</a> to create the TXT record and you'll end up with something like this:</p><p><img alt="TXT record" src="https://www.infoseczanshin.com/images/accessing-aws-vpc-with-openvpn-access-server/TXT_record.png"></p><p>Take this time to also create an <code>A</code> record set that maps the hostname of your OpenVPN server to the Elastic IP address you assigned to it in the previous section.</p><p>Finally, we need to configure OpenVPN Access Server to use these certificates. In order to be ready for automated renewal later on, let's do this by creating two scripts that I adapted from <a href="https://www.sideras.net/lets-encrypt-https-certificates-for-openvpn-as-access-server/">elsewhere</a>:</p><div class="highlight"><pre><span></span>cat &gt; /root/pre-hook.sh <span class="s">&lt;&lt; EOF</span>
<span class="s">#!/bin/sh</span>
<span class="s">/usr/local/openvpn_as/scripts/sacli stop</span>
<span class="s">EOF</span>

chmod a+x /root/pre-hook.sh

cat &gt; /root/post-hook.sh <span class="s">&lt;&lt; EOF</span>
<span class="s">#!/bin/sh</span>
<span class="s">/usr/local/openvpn_as/scripts/confdba -mk cs.ca_bundle -v &quot;`cat /etc/letsencrypt/live/openvpn.example.com/fullchain.pem`&quot;</span>
<span class="s">/usr/local/openvpn_as/scripts/confdba -mk cs.priv_key -v &quot;`cat /etc/letsencrypt/live/openvpn.example.com/privkey.pem`&quot; &gt; /dev/null</span>
<span class="s">/usr/local/openvpn_as/scripts/confdba -mk cs.cert -v &quot;`cat /etc/letsencrypt/live/openvpn.example.com/cert.pem`&quot;</span>
<span class="s">/usr/local/openvpn_as/scripts/sacli start</span>
<span class="s">EOF</span>

chmod a+x /root/pre-hook.sh
</pre></div><p>Please replace <code>openvpn.example.com</code> in the code above with the actual hostname you chose for your OpenVPN server. Then, you immediately run the scripts to load the newly created certificate:</p><div class="highlight"><pre><span></span>/root/pre-hook.sh
/root/post-hook.sh
</pre></div><p>If you use Route 53 we can setup the <a href="https://certbot.eff.org/docs/using.html#renewing-certificates">automated renewal</a> of these certificates by using <a href="https://github.com/jed/certbot-route53">certbot-route53</a>. First, download the script:</p><div class="highlight"><pre><span></span>curl -sL https://git.io/vylLx -o /root/certbot-route53.sh
chmod a+x /root/certbot-route53.sh
</pre></div><p>Then, ensure the IAM role associated with the OpenVPN instance has the following policy attached to it:</p><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;Version&quot;</span><span class="p">:</span> <span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Statement&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;route53:ListHostedZones&quot;</span><span class="p">,</span>
                <span class="s2">&quot;route53:ListHostedZonesByName&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;*&quot;</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;route53:ChangeResourceRecordSets&quot;</span><span class="p">,</span>
                <span class="s2">&quot;route53:GetHostedZone&quot;</span><span class="p">,</span>
                <span class="s2">&quot;route53:ListResourceRecordSets&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;arn:aws:route53:::hostedzone/&lt;your hosted zone ID&gt;&quot;</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;route53:GetChange&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;arn:aws:route53:::change/*&quot;</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div><p>Finally, create a regular task executed twice a day by running <code>crontab -e</code> as <code>root</code> and entering the following new entry:</p><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">1</span><span class="p">,</span><span class="mi">13</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">certbot</span><span class="o">-</span><span class="n">auto</span> <span class="n">renew</span> <span class="c1">--pre-hook &quot;/root/pre-hook.sh&quot; --post-hook &quot;/root/post-hook.sh&quot; --manual-auth-hook &quot;/root/certbot-route53.sh&quot; --manual-cleanup-hook &quot;/root/certbot-route53.sh&quot; --quiet --manual-public-ip-logging-ok</span>
</pre></div><p>Please choose an arbitrary number between 1 and 60 and replace the first <code>0</code> in the above line. Also choose different hours (instead of <code>1,13</code>) for executing this. If lots of people configure their cron jobs to hit Let's Encrypt at exactly the same times we might end up with an accidental DDoS.</p><p>At this point, you should be able to access the admin interface (by default in our example it would be <code>https://openvpn.example.com:943/admin</code>), and not get a warning about an invalid certificate. Just remove the <code>/admin</code> from the URL and you'll land on the <a href="https://openvpn.net/index.php/access-server/section-faq-openvpn-as/client-configuration.html">user-focused page</a> instead, where they can log in to download the client software binaries and profile configuration, and also scan Google Authenticator QR codes.</p><p>Go into the admin interface and perform the configuration that best suits your needs. We'll discuss two particularly interesting aspects of the configuration next.</p><h2>Routing</h2><p>You may choose to have OpenVPN use routing instead of NAT when it forwards traffic from the connected clients into the VPC environment. If you do that, you can use its ability to assign different users or groups of users IP addresses in different ranges. This, in turn, allows you to configure Security Group rules inside the VPC that will only allow certain users or groups of users to communicate with specific services.</p><p>If you do that, however, keep in mind that you'll need to take some additional steps:</p><ul><li><p>Ensure that the IP address ranges you assign VPN clients are <em>outside</em> the CIDR range for the entire VPC. So if your VPC has addresses on 172.16.0.0/16, you can't assign any part of that address space to VPN clients even if there are no VPC subnets currently using them.</p></li><li><p>You'll need to update your VPC routing configuration. For each CIDR of addresses that can be assigned to VPN clients, <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Route_Tables.html#AddRemoveRoutes">add a new route</a> with that CIDR as the <code>Destination</code> and the OpenVPN server instance as the <code>Target</code>. </p></li><li><p><a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_NAT_Instance.html#EIP_Disable_SrcDestCheck">Disable the source/destination check</a> on the OpenVPN Access Server instance so that it can "answer for" other ranges of IP address in the AWS network stack.</p></li></ul><h2>Google Authenticator</h2><p>If everything else is working at this point, requiring users to have two-factor authentication using Google Authenticator should be pretty easy by now. First, on the admin interface go to <code>Configuration</code> &nbsp;&rarr;&nbsp; <code>Client Settings</code> and check the box that says <code>Require that users provide a Google Authenticator one-time password for every VPN login</code>.</p><p>What it took me a while to figure out was how to enroll users. Basically what you do is create the user normally in the admin interface in <code>User Management</code> &nbsp;&rarr;&nbsp; <code>User Permissions</code>, and assign the user a password.</p><p>Then, the end user must log in to the non-admin web interface (<code>https://openvpn.example.com:943</code> in our example), and choose <code>Login</code> instead of <code>Connect</code>:</p><p><img alt="user login" src="https://www.infoseczanshin.com/images/accessing-aws-vpc-with-openvpn-access-server/user_login.png"></p><p>In this page, they'll the given the choice to download a connection client or a profile configuration they can import into an existing client. But they will also be displayed the QR code they'll scan using Google Authenticator. Once they do that, everything should be good to go.</p><h2>CloudWatch Logs Agent</h2><p>Next let's configure the <a href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/QuickStartEC2Instance.html">CloudWatch Logs Agent</a> so that the OpenVPN Server logs are centralized and easy to query if necessary, and also protected from any attackers that might gain access to the server.</p><p>Firstly, a minor adjustment is needed to allow the agent installation to go properly. The provided AWS installation script checks <code>/etc/issue</code> to determine which Linux distribution the machine uses. And OpenVPN Access Server has a custom string in that file. So we'll need to edit it to make sure the first line starts with <code>Ubuntu</code> or else the script will refuse to run.</p><p>I also recommend assigning the machine its proper hostname by issuing the following command as <code>root</code>:</p><div class="highlight"><pre><span></span>hostname openvpn.example.com
</pre></div><p>Then, make sure you edit <code>/etc/hostname</code> and <code>/etc/hosts</code> to make sure they also match the the full hostname.</p><p>Finally, you can then execute the <a href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/QuickStartEC2Instance.html">official AWS installation instructions</a> with the following three recommendations:</p><ul><li><p>Make sure you include <code>/var/log/openvpnas.log</code>, <code>/var/log/syslog</code> and <code>/var/log/auth.log</code> to the log collection.</p></li><li><p>When asked what the log stream name should be, I recommend you use the newly-configured machine name for clarity.</p></li><li><p>When asked about the timestamp format, choose to use a custom format and enter <code>%Y-%m-%dT%H:%M:%S%z</code>.</p></li></ul><p>Then, update <code>/etc/rsyslog.conf</code> as per <a href="http://serverfault.com/a/592120">these instructions</a> and restart the rsyslog service:</p><div class="highlight"><pre><span></span>service rsyslog restart
</pre></div><p>Finally, you'll need to enable the service to run via systemd (as <code>root</code>):</p><div class="highlight"><pre><span></span>systemctl <span class="nb">enable</span> awslogs
</pre></div><p>You should now see the new log groups on the AWS Console.</p><p>I would also like to suggest that you create a new file <code>/etc/logrotate.d/openvpnas</code> with the following content:</p><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">openvpnas</span><span class="p">.</span><span class="n">log</span> <span class="err">{</span>
  <span class="n">rotate</span> <span class="mi">90</span>
  <span class="n">daily</span>
  <span class="n">compress</span>
  <span class="n">missingok</span>
  <span class="n">notifempty</span>
<span class="err">}</span>
</pre></div><h2>Additional Recommendations</h2><p>A few security-minded tips that I would recommend you implement:</p><ul><li><p>Ensure you close off SSH access to the OpenVPN box after you're done configuring it, by removing the applicable Security Group inbound rule. If you need in you can always do that through the VPN access itself later on. And if you lock yourself out, you can always allow it temporarily again on the Security Group if and when you need it.</p></li><li><p>On the web admin interface, go to <code>Configuration</code> &nbsp;&rarr;&nbsp; <code>SSL Settings</code> and select <code>TLS 1.1</code> as the minimum for both the web server and OpenVPN server, as per <a href="https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet#Rule_-_Only_Support_Strong_Protocols">industry best practice</a>.</p></li><li><p>On the web admin interface, go to <code>Configuration</code> &nbsp;&rarr;&nbsp; <code>Advanced VPN Settings</code>. Under <code>Additional OpenVPN Config Directives (Advanced)</code>, replace <code>AES-128-CBC</code> with <code>AES-256-CBC</code> in both the client and server configuration directives for increased encryption security.</p></li><li><p>Harden the operating system and make sure to keep install security updates as they become available.</p></li></ul><a href="#" class="go-top">Go Top</a><div class="comments"><div id="disqus_thread"></div><script>
         /**
          * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
          * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
         */
         var disqus_config = function () {
           this.page.url = "https://www.infoseczanshin.com/using-openvpn-access-server-to-access-aws-vpcs.html"; // Replace PAGE_URL with your page's canonical URL variable
           this.page.identifier = "Using OpenVPN Access Server to Access AWS VPCs"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
         };
         (function() { // DON'T EDIT BELOW THIS LINE
           var d = document, s = d.createElement('script');

           s.src = '//infoseczanshin.disqus.com/embed.js';

           s.setAttribute('data-timestamp', +new Date());
           (d.head || d.body).appendChild(s);
         })();
       </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div><footer class="footer"><p>&copy; Alexandre Sieira &ndash; Built with a modified version of <a href="https://github.com/PurePelicanTheme/pure-single">Pure Theme</a> for <a href="http://blog.getpelican.com/">Pelican</a></p></footer></div></div></div><script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-73747222-1', 'auto');
  ga('send', 'pageview');

</script></body><script src="https://www.infoseczanshin.com/js/redirect.js"></script></html>