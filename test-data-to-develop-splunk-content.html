<!doctype html><html lang="en"><head><meta name="google-site-verification" content="iwCg_a-vVgFpfSWBajnl_3T97hetrL_jHS3nVkinaho"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="InfoSec Zanshin, Thoughts on information security, entrepreneurship and more."><link rel="alternate" href="https://asieira.github.io/feeds/all.atom.xml" type="application/atom+xml" title="InfoSec Zanshin Full Atom Feed"><title>Test Data to Develop Splunk Content // InfoSec Zanshin // Thoughts on information security, entrepreneurship and more.</title><link rel="apple-touch-icon" sizes="57x57" href="/images/favicon/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/images/favicon/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/images/favicon/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/images/favicon/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/images/favicon/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/images/favicon/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/images/favicon/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/images/favicon/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/images/favicon/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/images/favicon/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png"><link rel="manifest" href="/images/favicon/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/images/favicon/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://asieira.github.io/theme/css/pure.css"><link rel="stylesheet" href="https://asieira.github.io/theme/css/pygments.css"><script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script><script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script></head><body><div class="pure-g-r" id="layout"><div class="sidebar pure-u"><div class="cover-img" style="background: none repeat scroll 0% 0% #3D4F5D"><div class="cover-body"><header class="header"><hgroup><img class="avatar" src="/images/zanshin.png"><h1 class="brand-main"><a href="https://asieira.github.io">InfoSec Zanshin</a></h1><p class="tagline">Thoughts on information security, entrepreneurship and more.</p><p class="social"><a href="feeds/all.atom.xml" target="_blank"><i class="fa fa-rss-square fa-2x"></i></a><a href="https://br.linkedin.com/in/sieira" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a><a href="https://twitter.com/AlexandreSieira" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a><a href="https://github.com/asieira/" target="_blank"><i class="fa fa-github-square fa-2x"></i></a></p></hgroup></header></div></div></div><div class="pure-u"><div class="content"><section class="post"><header class="post-header"><h1>Test Data to Develop Splunk Content</h1><p class="post-meta"> // under <a class="post-category" href="https://asieira.github.io/tag/splunk.html">splunk</a><a class="post-category" href="https://asieira.github.io/tag/siem.html">siem</a></p><p class="post-meta"> // Tue 02 February 2016 </p></header></section><p><a href="http://splunk.com">Splunk</a> is the SIEM platform I have been working the most with recently. It is a joy to work with because it has embraced the development paradigm, and organizes standard and user-developed content into apps. And it lets you write code in proper languages like Python or Java to process the data in ways that go beyond their own query language.</p><p>Which brings me to how it is that you can develop and test an app for security devices and environments you don't personally have access to. Actual sample log data is not easy to come by. And even if you do find it some Splunk apps expect the log data to be ingested in particular ways (e.g. syslog), and replaying them from a file on disk is not always trivial. </p><p>This is a concern both if you are writing a new app that will be used by others, or if you want to ensure that your internal organization's apps are able to correctly handle log entries that are infrequent or that you might not have encountered before. For example, the <a href="https://docs.splunk.com/Documentation/CIM/latest/User/IntrusionDetection">Network Intrusion CIM model</a> does not specify a finite list of possible values for the <code>action</code> field. And until you see some test examples you won't know that the Check Point OPSEC TA field extractions will have the service name instead of the port number in the <code>dest_port</code> field of the <a href="https://docs.splunk.com/Documentation/CIM/latest/User/NetworkTraffic">Network Traffic CIM model</a>. So you'll need to get a representative set of events and find what out values the TAs actually generate if you want to ensure your content will adequately survive its first encounter with with real events out there in the wilderness.</p><p>Looking into this for the <a href="https://splunkbase.splunk.com/app/2777/">Niddel app</a> I stumbled upon a very useful tool called <a href="https://github.com/splunk/eventgen">eventgen</a>. Basically what I have found is that most Splunk-developed apps, and many developed by third parties, are shipped with configurations that allow you to easily generate sample log data that you can then use to test your content. </p><p>The <a href="https://github.com/splunk/eventgen/blob/develop/README/Tutorial.md">eventgen tutorial</a> is very thorough and the tool is very well documented. However the documentation is almost exclusively focused on app developers which want to support event generation in their apps. Very little is said about how to simply use the functionality the app developers already built-in. So let me try to help fill in the gaps here with the TL;DR version, which I only recommend for development-only Splunk instances:</p><ul><li><p>First, confirm if the particular app or TA you are interested in has that configuration: go to its directory under <code>$SPLUNK_HOME/etc/apps</code> (or download it from <a href="https://splunkbase.splunk.com">SplunkBase</a> and check within the archive) for a <code>samples</code> directory and a <code>default/eventgen.conf</code> file. If it's there, you're in luck.</p></li><li><p>Then, ensure that the apps or TA for which you want to generate events os configured to share their content globally, or the eventgen app (installed later) won't be able to access its sample data and configurations. The simplest way to do this is on Splunk Web is to navigate to <code>Apps</code> -&gt; <code>Manage Apps</code> and click on <code>Permissions</code> under the <code>Sharing</code> column for the app you want events from. Make sure the <code>Sharing for config file-only objects</code> option is set to <code>All apps</code>: <img alt="Splunk app permissions" src="https://asieira.github.io/images/splunk-test-data/app-permissions.png"></p></li><li><p>Download the <a href="https://github.com/splunk/eventgen/">eventgen GitHub repository</a> as a <a href="https://github.com/splunk/eventgen/archive/develop.zip">ZIP file</a> and install it as a Splunk app in <code>Apps</code> -&gt; <code>Manage Apps</code> -&gt; <code>Install app from file</code>.</p></li><li><p>The new eventgen app does not have a setup page when you go to it under <code>Apps</code>, just statistics on the generated events. So the only way I found to enable and disable it is to go to <code>Apps</code> -&gt; <code>Manage Apps</code> and click on <code>Set Up</code> on the row of the eventgen app. Mark and unmark the <code>Enable ./bin/eventgen.py</code> checkbox to enable/disable event generation.</p></li></ul><p>Once this is done, eventgen will inspect all other installed apps it can access (hence the permissions step above) and generate fake events for them according to their configurations, usually directly to the <code>main</code> index. No easy way to choose which apps to generate events from at this time, unfortunately.</p><a href="#" class="go-top">Go Top</a><div class="comments"><div id="disqus_thread"></div><script>
         /**
          * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
          * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
         */
         var disqus_config = function () {
           this.page.url = "https://asieira.github.io/test-data-to-develop-splunk-content.html"; // Replace PAGE_URL with your page's canonical URL variable
           this.page.identifier = "Test Data to Develop Splunk Content"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
         };
         (function() { // DON'T EDIT BELOW THIS LINE
           var d = document, s = d.createElement('script');

           s.src = '//infoseczanshin.disqus.com/embed.js';

           s.setAttribute('data-timestamp', +new Date());
           (d.head || d.body).appendChild(s);
         })();
       </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div><footer class="footer"><p>&copy; Alexandre Sieira &ndash; Built with a modified version of <a href="https://github.com/PurePelicanTheme/pure-single">Pure Theme</a> for <a href="http://blog.getpelican.com/">Pelican</a></p></footer></div></div></div><script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-73747222-1', 'auto');
  ga('send', 'pageview');

</script></body></html>